<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"The Book of Shaders &#x5b66;&#x4e60;&#x7b14;&#x8bb0;","children":[{"content":"&#x4e00;&#x3001;&#x7740;&#x8272;&#x5668;&#x57fa;&#x7840;","children":[{"content":"1.1 &#x4ec0;&#x4e48;&#x662f;&#x7740;&#x8272;&#x5668;","children":[{"content":"<pre data-lines=\"8,15\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x57fa;&#x7840;&#x7247;&#x6bb5;&#x7740;&#x8272;&#x5668;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-type\">void</span> main() {\n    <span class=\"hljs-comment\">// &#x8bbe;&#x7f6e;&#x50cf;&#x7d20;&#x989c;&#x8272;&#x4e3a;&#x7ea2;&#x8272;</span>\n    <span class=\"hljs-built_in\">gl_FragColor</span> = <span class=\"hljs-type\">vec4</span>(<span class=\"hljs-number\">1.0</span>, <span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">1.0</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"8,15"}}],"payload":{"tag":"h3","lines":"4,5"}},{"content":"1.2 &#x7740;&#x8272;&#x5668;&#x7c7b;&#x578b;","children":[{"content":"&#x9876;&#x70b9;&#x7740;&#x8272;&#x5668;(Vertex Shader): &#x5904;&#x7406;&#x9876;&#x70b9;&#x4f4d;&#x7f6e;&#x548c;&#x5c5e;&#x6027;<pre data-lines=\"28,38\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x9876;&#x70b9;&#x7740;&#x8272;&#x5668;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-keyword\">attribute</span> <span class=\"hljs-type\">vec3</span> position;\n<span class=\"hljs-keyword\">uniform</span> <span class=\"hljs-type\">mat4</span> modelViewMatrix;\n<span class=\"hljs-keyword\">uniform</span> <span class=\"hljs-type\">mat4</span> projectionMatrix;\n\n<span class=\"hljs-type\">void</span> main() {\n    <span class=\"hljs-built_in\">gl_Position</span> = projectionMatrix * modelViewMatrix * <span class=\"hljs-type\">vec4</span>(position, <span class=\"hljs-number\">1.0</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"27,38"}},{"content":"&#x7247;&#x6bb5;&#x7740;&#x8272;&#x5668;(Fragment Shader): &#x5904;&#x7406;&#x50cf;&#x7d20;&#x989c;&#x8272;&#x8ba1;&#x7b97;<pre data-lines=\"39,50\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x7247;&#x6bb5;&#x7740;&#x8272;&#x5668;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-keyword\">uniform</span> <span class=\"hljs-type\">vec2</span> u_resolution;\n<span class=\"hljs-keyword\">uniform</span> <span class=\"hljs-type\">float</span> u_time;\n\n<span class=\"hljs-type\">void</span> main() {\n    <span class=\"hljs-type\">vec2</span> st = <span class=\"hljs-built_in\">gl_FragCoord</span>.xy/u_resolution.xy;\n    <span class=\"hljs-type\">vec3</span> color = <span class=\"hljs-type\">vec3</span>(st.x, st.y, <span class=\"hljs-built_in\">abs</span>(<span class=\"hljs-built_in\">sin</span>(u_time)));\n    <span class=\"hljs-built_in\">gl_FragColor</span> = <span class=\"hljs-type\">vec4</span>(color, <span class=\"hljs-number\">1.0</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"38,51"}}],"payload":{"tag":"h3","lines":"25,26"}},{"content":"1.3 GLSL&#x8bed;&#x8a00;&#x57fa;&#x7840;","children":[{"content":"","children":[{"content":"&#x7c7b;C&#x8bed;&#x6cd5;","children":[],"payload":{"tag":"li","lines":"53,54"}},{"content":"&#x5185;&#x7f6e;&#x6570;&#x636e;&#x7c7b;&#x578b;:","children":[{"content":"vec2: 2D&#x5411;&#x91cf;","children":[],"payload":{"tag":"li","lines":"55,56"}},{"content":"vec3: 3D&#x5411;&#x91cf;","children":[],"payload":{"tag":"li","lines":"56,57"}},{"content":"vec4: 4D&#x5411;&#x91cf;","children":[],"payload":{"tag":"li","lines":"57,58"}},{"content":"mat2/3/4: 2x2/3x3/4x4&#x77e9;&#x9635;","children":[],"payload":{"tag":"li","lines":"58,59"}}],"payload":{"tag":"li","lines":"54,59"}},{"content":"&#x5185;&#x7f6e;&#x51fd;&#x6570;:<pre data-lines=\"60,65\"><code class=\"language-glsl\"><span class=\"hljs-type\">float</span> a = <span class=\"hljs-built_in\">sin</span>(<span class=\"hljs-number\">3.14</span>); <span class=\"hljs-comment\">// &#x4e09;&#x89d2;&#x51fd;&#x6570;</span>\n<span class=\"hljs-type\">float</span> b = <span class=\"hljs-built_in\">pow</span>(<span class=\"hljs-number\">2.0</span>, <span class=\"hljs-number\">3.0</span>); <span class=\"hljs-comment\">// &#x5e42;&#x51fd;&#x6570;</span>\n<span class=\"hljs-type\">vec3</span> c = <span class=\"hljs-built_in\">mix</span>(<span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">1.0</span>), <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>), <span class=\"hljs-number\">0.5</span>); <span class=\"hljs-comment\">// &#x7ebf;&#x6027;&#x63d2;&#x503c;</span>\n</code></pre>","children":[],"payload":{"tag":"li","lines":"59,66"}}],"payload":{"tag":"ul","lines":"53,66"}},{"content":"","children":[{"content":"1. &#x51cf;&#x5c11;&#x5206;&#x652f;&#x8bed;&#x53e5;(if/else)","children":[],"payload":{"tag":"li","lines":"67,68","listIndex":1}},{"content":"2. &#x4f7f;&#x7528;&#x5185;&#x7f6e;&#x51fd;&#x6570;&#x800c;&#x4e0d;&#x662f;&#x81ea;&#x5df1;&#x5b9e;&#x73b0;","children":[],"payload":{"tag":"li","lines":"68,69","listIndex":2}},{"content":"3. &#x5c3d;&#x91cf;&#x590d;&#x7528;&#x8ba1;&#x7b97;&#x7ed3;&#x679c;","children":[],"payload":{"tag":"li","lines":"69,70","listIndex":3}},{"content":"4. &#x6ce8;&#x610f;&#x7cbe;&#x5ea6;&#x9650;&#x5b9a;&#x7b26;&#x7684;&#x4f7f;&#x7528;(lowp, mediump, highp)","children":[],"payload":{"tag":"li","lines":"70,72","listIndex":4}}],"payload":{"tag":"ol","lines":"67,72"}}],"payload":{"tag":"h3","lines":"51,52"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"&#x4e8c;&#x3001;&#x57fa;&#x7840;&#x56fe;&#x5f62;&#x7ed8;&#x5236;","children":[{"content":"2.1 &#x989c;&#x8272;&#x8868;&#x793a;","children":[{"content":"<pre data-lines=\"76,80\"><code class=\"language-glsl\"><span class=\"hljs-type\">vec4</span> color = <span class=\"hljs-type\">vec4</span>(<span class=\"hljs-number\">1.0</span>, <span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">1.0</span>); <span class=\"hljs-comment\">// &#x7ea2;&#x8272;</span>\n<span class=\"hljs-comment\">// r,g,b,a &#x5206;&#x91cf;&#x8303;&#x56f4;&#x5747;&#x4e3a; 0.0 - 1.0</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"76,80"}}],"payload":{"tag":"h3","lines":"74,75"}},{"content":"2.2 &#x5f62;&#x72b6;&#x7ed8;&#x5236;","children":[{"content":"<pre data-lines=\"83,95\"><code class=\"language-glsl\"><span class=\"hljs-type\">float</span> circle(<span class=\"hljs-type\">vec2</span> st, <span class=\"hljs-type\">vec2</span> center, <span class=\"hljs-type\">float</span> radius) {\n    <span class=\"hljs-type\">vec2</span> dist = st - center;\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">smoothstep</span>(radius-(radius*<span class=\"hljs-number\">0.01</span>), radius+(radius*<span class=\"hljs-number\">0.01</span>), <span class=\"hljs-built_in\">dot</span>(dist,dist)*<span class=\"hljs-number\">4.0</span>);\n}\n\n<span class=\"hljs-type\">void</span> main() {\n    <span class=\"hljs-type\">vec2</span> st = <span class=\"hljs-built_in\">gl_FragCoord</span>.xy/u_resolution.xy;\n    <span class=\"hljs-type\">vec3</span> color = <span class=\"hljs-type\">vec3</span>(circle(st, <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">0.5</span>), <span class=\"hljs-number\">0.3</span>));\n    <span class=\"hljs-built_in\">gl_FragColor</span> = <span class=\"hljs-type\">vec4</span>(color, <span class=\"hljs-number\">1.0</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"83,95"}}],"payload":{"tag":"h3","lines":"81,82"}},{"content":"2.3 &#x56fe;&#x6848;&#x548c;&#x7eb9;&#x7406;","children":[{"content":"<pre data-lines=\"98,118\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x57fa;&#x7840;&#x566a;&#x58f0;&#x51fd;&#x6570;</span>\n<span class=\"hljs-type\">float</span> random(<span class=\"hljs-type\">vec2</span> st) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">fract</span>(<span class=\"hljs-built_in\">sin</span>(<span class=\"hljs-built_in\">dot</span>(st.xy, <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">12.9898</span>,<span class=\"hljs-number\">78.233</span>))) * <span class=\"hljs-number\">43758.5453123</span>);\n}\n\n<span class=\"hljs-comment\">// Perlin&#x566a;&#x58f0;&#x5b9e;&#x73b0;</span>\n<span class=\"hljs-type\">float</span> noise(<span class=\"hljs-type\">vec2</span> st) {\n    <span class=\"hljs-type\">vec2</span> i = <span class=\"hljs-built_in\">floor</span>(st);\n    <span class=\"hljs-type\">vec2</span> f = <span class=\"hljs-built_in\">fract</span>(st);\n    \n    <span class=\"hljs-type\">float</span> a = random(i);\n    <span class=\"hljs-type\">float</span> b = random(i + <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">1.0</span>, <span class=\"hljs-number\">0.0</span>));\n    <span class=\"hljs-type\">float</span> c = random(i + <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">1.0</span>));\n    <span class=\"hljs-type\">float</span> d = random(i + <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">1.0</span>, <span class=\"hljs-number\">1.0</span>));\n\n    <span class=\"hljs-type\">vec2</span> u = f * f * (<span class=\"hljs-number\">3.0</span> - <span class=\"hljs-number\">2.0</span> * f);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">mix</span>(a, b, u.x) + (c - a)* u.y * (<span class=\"hljs-number\">1.0</span> - u.x) + (d - b) * u.x * u.y;\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"98,118"}}],"payload":{"tag":"h3","lines":"96,97"}}],"payload":{"tag":"h2","lines":"72,73"}},{"content":"&#x4e09;&#x3001;&#x9ad8;&#x7ea7;&#x6280;&#x672f;","children":[{"content":"3.1 &#x5149;&#x7167;&#x8ba1;&#x7b97;","children":[{"content":"<pre data-lines=\"123,130\"><code class=\"language-glsl\"><span class=\"hljs-type\">vec3</span> calculateLighting(<span class=\"hljs-type\">vec3</span> normal, <span class=\"hljs-type\">vec3</span> lightDir) {\n    <span class=\"hljs-type\">float</span> diff = <span class=\"hljs-built_in\">max</span>(<span class=\"hljs-built_in\">dot</span>(normal, lightDir), <span class=\"hljs-number\">0.0</span>);\n    <span class=\"hljs-type\">vec3</span> diffuse = diff * lightColor;\n    <span class=\"hljs-keyword\">return</span> ambient + diffuse;\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"123,130"}}],"payload":{"tag":"h3","lines":"121,122"}},{"content":"3.2 &#x540e;&#x671f;&#x5904;&#x7406;","children":[{"content":"<pre data-lines=\"133,149\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x9ad8;&#x65af;&#x6a21;&#x7cca;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-type\">vec4</span> blur(<span class=\"hljs-type\">sampler2D</span> image, <span class=\"hljs-type\">vec2</span> uv, <span class=\"hljs-type\">vec2</span> resolution) {\n    <span class=\"hljs-type\">vec4</span> color = <span class=\"hljs-type\">vec4</span>(<span class=\"hljs-number\">0.0</span>);\n    <span class=\"hljs-type\">vec2</span> off1 = <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">1.3846153846</span>) / resolution;\n    <span class=\"hljs-type\">vec2</span> off2 = <span class=\"hljs-type\">vec2</span>(<span class=\"hljs-number\">3.2307692308</span>) / resolution;\n    \n    color += <span class=\"hljs-built_in\">texture2D</span>(image, uv) * <span class=\"hljs-number\">0.2270270270</span>;\n    color += <span class=\"hljs-built_in\">texture2D</span>(image, uv + off1) * <span class=\"hljs-number\">0.3162162162</span>;\n    color += <span class=\"hljs-built_in\">texture2D</span>(image, uv - off1) * <span class=\"hljs-number\">0.3162162162</span>;\n    color += <span class=\"hljs-built_in\">texture2D</span>(image, uv + off2) * <span class=\"hljs-number\">0.0702702703</span>;\n    color += <span class=\"hljs-built_in\">texture2D</span>(image, uv - off2) * <span class=\"hljs-number\">0.0702702703</span>;\n    \n    <span class=\"hljs-keyword\">return</span> color;\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"133,149"}}],"payload":{"tag":"h3","lines":"131,132"}},{"content":"3.3 &#x7a0b;&#x5e8f;&#x5316;&#x7eb9;&#x7406;","children":[{"content":"<pre data-lines=\"152,165\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x68cb;&#x76d8;&#x683c;&#x7eb9;&#x7406;</span>\n<span class=\"hljs-type\">float</span> checkerboard(<span class=\"hljs-type\">vec2</span> st, <span class=\"hljs-type\">float</span> size) {\n    <span class=\"hljs-type\">vec2</span> pos = <span class=\"hljs-built_in\">floor</span>(st * size);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">mod</span>(pos.x + pos.y, <span class=\"hljs-number\">2.0</span>);\n}\n\n<span class=\"hljs-comment\">// &#x6728;&#x7eb9;&#x7eb9;&#x7406;</span>\n<span class=\"hljs-type\">float</span> wood(<span class=\"hljs-type\">vec2</span> st) {\n    <span class=\"hljs-type\">float</span> noise = noise(st * <span class=\"hljs-number\">10.0</span>);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">fract</span>(noise * <span class=\"hljs-number\">10.0</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"152,165"}}],"payload":{"tag":"h3","lines":"150,151"}}],"payload":{"tag":"h2","lines":"119,120"}},{"content":"&#x56db;&#x3001;&#x9ad8;&#x7ea7;&#x6e32;&#x67d3;&#x6280;&#x672f;","children":[{"content":"4.1 &#x5149;&#x7ebf;&#x6b65;&#x8fdb;(Ray Marching)","children":[{"content":"<pre data-lines=\"171,200\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x57fa;&#x7840;&#x7403;&#x4f53;SDF(&#x6709;&#x7b26;&#x53f7;&#x8ddd;&#x79bb;&#x51fd;&#x6570;)</span>\n<span class=\"hljs-type\">float</span> sphereSDF(<span class=\"hljs-type\">vec3</span> p, <span class=\"hljs-type\">vec3</span> center, <span class=\"hljs-type\">float</span> radius) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">length</span>(p - center) - radius;\n}\n\n<span class=\"hljs-comment\">// &#x5149;&#x7ebf;&#x6b65;&#x8fdb;&#x4e3b;&#x5faa;&#x73af;</span>\n<span class=\"hljs-type\">vec3</span> rayMarch(<span class=\"hljs-type\">vec3</span> ro, <span class=\"hljs-type\">vec3</span> rd) {\n    <span class=\"hljs-type\">float</span> totalDistance = <span class=\"hljs-number\">0.0</span>;\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">int</span> STEPS = <span class=\"hljs-number\">32</span>;\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">float</span> MIN_DIST = <span class=\"hljs-number\">0.001</span>;\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">float</span> MAX_DIST = <span class=\"hljs-number\">100.0</span>;\n    \n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; STEPS; i++) {\n        <span class=\"hljs-type\">vec3</span> pos = ro + rd * totalDistance;\n        <span class=\"hljs-type\">float</span> dist = sphereSDF(pos, <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>), <span class=\"hljs-number\">1.0</span>);\n        \n        <span class=\"hljs-keyword\">if</span>(dist &lt; MIN_DIST) {\n            <span class=\"hljs-comment\">// &#x8ba1;&#x7b97;&#x6cd5;&#x7ebf;&#x548c;&#x5149;&#x7167;</span>\n            <span class=\"hljs-type\">vec3</span> normal = calcNormal(pos);\n            <span class=\"hljs-keyword\">return</span> shade(normal);\n        }\n        \n        totalDistance += dist;\n        <span class=\"hljs-keyword\">if</span>(totalDistance &gt; MAX_DIST) <span class=\"hljs-keyword\">break</span>;\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>); <span class=\"hljs-comment\">// &#x80cc;&#x666f;&#x8272;</span>\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"171,200"}}],"payload":{"tag":"h3","lines":"168,169"}},{"content":"4.2 PBR&#x6750;&#x8d28;&#x7cfb;&#x7edf;","children":[{"content":"<pre data-lines=\"204,244\"><code class=\"language-glsl\">struct Material {\n    <span class=\"hljs-type\">vec3</span> albedo;\n    <span class=\"hljs-type\">float</span> metallic;\n    <span class=\"hljs-type\">float</span> roughness;\n    <span class=\"hljs-type\">float</span> ao;\n};\n\n<span class=\"hljs-type\">vec3</span> calculatePBR(<span class=\"hljs-type\">vec3</span> worldPos, <span class=\"hljs-type\">vec3</span> normal, Material material) {\n    <span class=\"hljs-type\">vec3</span> N = <span class=\"hljs-built_in\">normalize</span>(normal);\n    <span class=\"hljs-type\">vec3</span> V = <span class=\"hljs-built_in\">normalize</span>(cameraPos - worldPos);\n    \n    <span class=\"hljs-type\">vec3</span> F0 = <span class=\"hljs-built_in\">mix</span>(<span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.04</span>), material.albedo, material.metallic);\n    <span class=\"hljs-type\">vec3</span> Lo = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>);\n    \n    <span class=\"hljs-comment\">// &#x8ba1;&#x7b97;&#x76f4;&#x63a5;&#x5149;&#x7167;</span>\n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">4</span>; i++) {\n        <span class=\"hljs-type\">vec3</span> L = <span class=\"hljs-built_in\">normalize</span>(lightPositions[i] - worldPos);\n        <span class=\"hljs-type\">vec3</span> H = <span class=\"hljs-built_in\">normalize</span>(V + L);\n        \n        <span class=\"hljs-type\">float</span> NDF = DistributionGGX(N, H, material.roughness);\n        <span class=\"hljs-type\">float</span> G = GeometrySmith(N, V, L, material.roughness);\n        <span class=\"hljs-type\">vec3</span> F = fresnelSchlick(<span class=\"hljs-built_in\">max</span>(<span class=\"hljs-built_in\">dot</span>(H, V), <span class=\"hljs-number\">0.0</span>), F0);\n        \n        <span class=\"hljs-type\">vec3</span> numerator = NDF * G * F;\n        <span class=\"hljs-type\">float</span> denominator = <span class=\"hljs-number\">4.0</span> * <span class=\"hljs-built_in\">max</span>(<span class=\"hljs-built_in\">dot</span>(N, V), <span class=\"hljs-number\">0.0</span>) * <span class=\"hljs-built_in\">max</span>(<span class=\"hljs-built_in\">dot</span>(N, L), <span class=\"hljs-number\">0.0</span>);\n        <span class=\"hljs-type\">vec3</span> specular = numerator / <span class=\"hljs-built_in\">max</span>(denominator, <span class=\"hljs-number\">0.001</span>);\n        \n        <span class=\"hljs-type\">vec3</span> kS = F;\n        <span class=\"hljs-type\">vec3</span> kD = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">1.0</span>) - kS;\n        kD *= <span class=\"hljs-number\">1.0</span> - material.metallic;\n        \n        <span class=\"hljs-type\">float</span> NdotL = <span class=\"hljs-built_in\">max</span>(<span class=\"hljs-built_in\">dot</span>(N, L), <span class=\"hljs-number\">0.0</span>);\n        Lo += (kD * material.albedo / PI + specular) * lightColors[i] * NdotL;\n    }\n    \n    <span class=\"hljs-type\">vec3</span> ambient = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.03</span>) * material.albedo * material.ao;\n    <span class=\"hljs-keyword\">return</span> ambient + Lo;\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"204,244"}}],"payload":{"tag":"h3","lines":"201,202"}},{"content":"4.3 &#x9ad8;&#x7ea7;&#x540e;&#x671f;&#x5904;&#x7406;","children":[{"content":"<pre data-lines=\"248,271\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x666f;&#x6df1;&#x6548;&#x679c;</span>\n<span class=\"hljs-type\">vec3</span> depthOfField(<span class=\"hljs-type\">sampler2D</span> tex, <span class=\"hljs-type\">vec2</span> uv, <span class=\"hljs-type\">float</span> focusPoint, <span class=\"hljs-type\">float</span> aperture) {\n    <span class=\"hljs-type\">vec3</span> color = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>);\n    <span class=\"hljs-type\">float</span> blurAmount = <span class=\"hljs-built_in\">abs</span>(<span class=\"hljs-built_in\">texture2D</span>(depthTex, uv).r - focusPoint) * aperture;\n    \n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; SAMPLES; i++) {\n        <span class=\"hljs-type\">vec2</span> <span class=\"hljs-keyword\">offset</span> = poissonDisk[i] * blurAmount;\n        color += <span class=\"hljs-built_in\">texture2D</span>(tex, uv + <span class=\"hljs-keyword\">offset</span>).rgb;\n    }\n    <span class=\"hljs-keyword\">return</span> color / <span class=\"hljs-type\">float</span>(SAMPLES);\n}\n\n<span class=\"hljs-comment\">// &#x5168;&#x5c40;&#x5149;&#x7167;</span>\n<span class=\"hljs-type\">vec3</span> calculateGI(<span class=\"hljs-type\">vec3</span> pos, <span class=\"hljs-type\">vec3</span> normal) {\n    <span class=\"hljs-type\">vec3</span> indirectLight = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>);\n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; SAMPLES; i++) {\n        <span class=\"hljs-type\">vec3</span> sampleDir = sampleHemisphere(normal, i);\n        indirectLight += rayMarch(pos, sampleDir);\n    }\n    <span class=\"hljs-keyword\">return</span> indirectLight / <span class=\"hljs-type\">float</span>(SAMPLES);\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"248,271"}}],"payload":{"tag":"h3","lines":"245,246"}}],"payload":{"tag":"h2","lines":"166,167"}},{"content":"&#x4e94;&#x3001;&#x6027;&#x80fd;&#x4f18;&#x5316;","children":[{"content":"5.1 &#x7740;&#x8272;&#x5668;&#x4f18;&#x5316;&#x6280;&#x5de7;","children":[{"content":"<pre data-lines=\"276,287\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x4e0d;&#x63a8;&#x8350;</span>\n<span class=\"hljs-keyword\">if</span>(condition) {\n    color = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">1.0</span>);\n} <span class=\"hljs-keyword\">else</span> {\n    color = <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>);\n}\n\n<span class=\"hljs-comment\">// &#x63a8;&#x8350;</span>\ncolor = <span class=\"hljs-built_in\">mix</span>(<span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">0.0</span>), <span class=\"hljs-type\">vec3</span>(<span class=\"hljs-number\">1.0</span>), <span class=\"hljs-type\">float</span>(condition));\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"276,287"}},{"content":"<pre data-lines=\"289,299\"><code class=\"language-glsl\"><span class=\"hljs-comment\">// &#x4e0d;&#x63a8;&#x8350;</span>\n<span class=\"hljs-type\">float</span> len = <span class=\"hljs-built_in\">sqrt</span>(<span class=\"hljs-built_in\">dot</span>(v,v));\n\n<span class=\"hljs-comment\">// &#x63a8;&#x8350;(&#x907f;&#x514d;&#x4e0d;&#x5fc5;&#x8981;&#x7684;&#x5f52;&#x4e00;&#x5316;)</span>\n<span class=\"hljs-type\">float</span> lenSq = <span class=\"hljs-built_in\">dot</span>(v,v);\n<span class=\"hljs-keyword\">if</span>(lenSq &gt; radius * radius) {\n    <span class=\"hljs-comment\">// ...</span>\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"289,299"}}],"payload":{"tag":"h3","lines":"274,275"}},{"content":"5.2 &#x5185;&#x5b58;&#x4f18;&#x5316;","children":[{"content":"<pre data-lines=\"302,306\"><code class=\"language-glsl\"><span class=\"hljs-keyword\">precision</span> <span class=\"hljs-keyword\">mediump</span> <span class=\"hljs-type\">float</span>; <span class=\"hljs-comment\">// &#x9ed8;&#x8ba4;&#x7cbe;&#x5ea6;</span>\n<span class=\"hljs-keyword\">precision</span> <span class=\"hljs-keyword\">highp</span> <span class=\"hljs-type\">float</span>;   <span class=\"hljs-comment\">// &#x9700;&#x8981;&#x9ad8;&#x7cbe;&#x5ea6;&#x65f6;&#x4f7f;&#x7528;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"302,306"}},{"content":"<pre data-lines=\"308,313\"><code class=\"language-glsl\"><span class=\"hljs-type\">vec3</span> normal = <span class=\"hljs-built_in\">normalize</span>(v);\n<span class=\"hljs-type\">float</span> NdotL = <span class=\"hljs-built_in\">dot</span>(normal, lightDir);\n<span class=\"hljs-type\">float</span> NdotV = <span class=\"hljs-built_in\">dot</span>(normal, viewDir);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"308,313"}}],"payload":{"tag":"h3","lines":"300,301"}}],"payload":{"tag":"h2","lines":"272,273"}},{"content":"&#x5b66;&#x4e60;&#x8d44;&#x6e90;","children":[{"content":"<a href=\"https://thebookofshaders.com/\">The Book of Shaders&#x5b98;&#x7f51;</a>","children":[],"payload":{"tag":"li","lines":"315,316"}},{"content":"<a href=\"https://www.shadertoy.com/\">Shadertoy</a>","children":[],"payload":{"tag":"li","lines":"316,317"}},{"content":"<a href=\"http://glslsandbox.com/\">GLSL Sandbox</a>","children":[],"payload":{"tag":"li","lines":"317,318"}},{"content":"<a href=\"https://iquilezles.org/\">Inigo Quilez&#x7684;&#x535a;&#x5ba2;</a>","children":[],"payload":{"tag":"li","lines":"318,319"}},{"content":"<a href=\"https://michaelwalczyk.com/blog-ray-marching.html\">Ray Marching&#x6559;&#x7a0b;</a>","children":[],"payload":{"tag":"li","lines":"319,321"}}],"payload":{"tag":"h2","lines":"314,315"}},{"content":"&#x5b9e;&#x8df5;&#x9879;&#x76ee;","children":[{"content":"1. \n<p data-lines=\"322,323\">&#x57fa;&#x7840;&#x5f62;&#x72b6;&#x7ed8;&#x5236;</p>","children":[{"content":"&#x5b9e;&#x73b0;&#x5706;&#x5f62;&#x3001;&#x77e9;&#x5f62;&#x7b49;&#x57fa;&#x672c;&#x56fe;&#x5f62;","children":[],"payload":{"tag":"li","lines":"323,324"}},{"content":"&#x6dfb;&#x52a0;&#x52a8;&#x753b;&#x6548;&#x679c;","children":[],"payload":{"tag":"li","lines":"324,326"}}],"payload":{"tag":"li","lines":"322,326","listIndex":1}},{"content":"2. \n<p data-lines=\"326,327\">&#x7a0b;&#x5e8f;&#x5316;&#x56fe;&#x6848;&#x751f;&#x6210;</p>","children":[{"content":"&#x5b9e;&#x73b0;&#x68cb;&#x76d8;&#x683c;&#x7eb9;&#x7406;","children":[],"payload":{"tag":"li","lines":"327,328"}},{"content":"&#x521b;&#x5efa;&#x6e10;&#x53d8;&#x6548;&#x679c;","children":[],"payload":{"tag":"li","lines":"328,329"}},{"content":"&#x6dfb;&#x52a0;&#x566a;&#x58f0;&#x56fe;&#x6848;","children":[],"payload":{"tag":"li","lines":"329,331"}}],"payload":{"tag":"li","lines":"326,331","listIndex":2}},{"content":"3. \n<p data-lines=\"331,332\">&#x9ad8;&#x7ea7;&#x6e32;&#x67d3;&#x6548;&#x679c;</p>","children":[{"content":"&#x5b9e;&#x73b0;PBR&#x6750;&#x8d28;&#x7cfb;&#x7edf;","children":[],"payload":{"tag":"li","lines":"332,333"}},{"content":"&#x6dfb;&#x52a0;&#x5149;&#x7ebf;&#x6b65;&#x8fdb;&#x6548;&#x679c;","children":[],"payload":{"tag":"li","lines":"333,334"}},{"content":"&#x540e;&#x671f;&#x5904;&#x7406;&#x7ba1;&#x7ebf;&#x642d;&#x5efa;","children":[],"payload":{"tag":"li","lines":"334,336"}}],"payload":{"tag":"li","lines":"331,336","listIndex":3}}],"payload":{"tag":"h2","lines":"321,322"}},{"content":"&#x6ce8;&#x610f;&#x4e8b;&#x9879;","children":[{"content":"1. \n<p data-lines=\"337,338\">&#x7406;&#x89e3;GPU&#x5e76;&#x884c;&#x5904;&#x7406;&#x7279;&#x6027;</p>","children":[{"content":"&#x907f;&#x514d;&#x5206;&#x652f;&#x8bed;&#x53e5;","children":[],"payload":{"tag":"li","lines":"338,339"}},{"content":"&#x6ce8;&#x610f;&#x6570;&#x636e;&#x4f9d;&#x8d56;","children":[],"payload":{"tag":"li","lines":"339,341"}}],"payload":{"tag":"li","lines":"337,341","listIndex":1}},{"content":"2. \n<p data-lines=\"341,342\">&#x6ce8;&#x610f;&#x6027;&#x80fd;&#x4f18;&#x5316;</p>","children":[{"content":"&#x51cf;&#x5c11;&#x7eb9;&#x7406;&#x91c7;&#x6837;","children":[],"payload":{"tag":"li","lines":"342,343"}},{"content":"&#x4f18;&#x5316;&#x6570;&#x5b66;&#x8ba1;&#x7b97;","children":[],"payload":{"tag":"li","lines":"343,344"}},{"content":"&#x4f7f;&#x7528;&#x9002;&#x5f53;&#x7684;&#x7cbe;&#x5ea6;","children":[],"payload":{"tag":"li","lines":"344,346"}}],"payload":{"tag":"li","lines":"341,346","listIndex":2}},{"content":"3. \n<p data-lines=\"346,347\">&#x591a;&#x7ec3;&#x4e60;&#x548c;&#x5b9e;&#x9a8c;</p>","children":[{"content":"&#x4ece;&#x7b80;&#x5355;&#x6548;&#x679c;&#x5f00;&#x59cb;","children":[],"payload":{"tag":"li","lines":"347,348"}},{"content":"&#x9010;&#x6b65;&#x589e;&#x52a0;&#x590d;&#x6742;&#x5ea6;","children":[],"payload":{"tag":"li","lines":"348,349"}},{"content":"&#x53c2;&#x8003;&#x4ed6;&#x4eba;&#x4ee3;&#x7801;&#x5b66;&#x4e60;","children":[],"payload":{"tag":"li","lines":"349,350"}}],"payload":{"tag":"li","lines":"346,350","listIndex":3}}],"payload":{"tag":"h2","lines":"336,337"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
